import"./chunk-BYXBJQAS.js";import{a as G}from"./chunk-UUK2MEKI.js";import{a as Se}from"./chunk-ZXEL4EV3.js";import{b as _e,c as Ce,d as fe,f as be,h as ye,i as he,j as xe,k as ve}from"./chunk-KH62GCST.js";import{a as M,b as y}from"./chunk-MUSGDK5O.js";import{a as ne,b as oe,c as re,d as ae,e as se,f as le,g as ce,h as pe,i as me,j as ge,k as de,l as ue}from"./chunk-6EW4IUTA.js";import{i as K}from"./chunk-SPF45QKE.js";import{c as J,e as X,j as Y,s as Z,t as ee,v as te,x as ie}from"./chunk-Y5TDRMM2.js";import"./chunk-TU2ZNCML.js";import{d as U}from"./chunk-63TX3NUI.js";import"./chunk-ZOPMU54Y.js";import{j as W,l as j,o as R}from"./chunk-KALLYKT4.js";import{$b as B,Ab as u,Eb as _,Jb as C,Kb as s,Qb as V,Rb as I,Sb as N,Tb as D,Ub as p,Vb as $,Wa as T,Wb as q,Yb as S,Za as m,Zb as E,_a as k,_b as w,ac as H,ec as z,gc as L,hc as Q,ic as A,jc as O,la as f,nb as b,oa as P,pb as c,vb as F,wb as x,xb as v,ya as g,yb as o,za as d,zb as a}from"./chunk-MLHGNWXV.js";var we=(t,l)=>l.id,Le=(t,l,e)=>({id:"categories-pagination",itemsPerPage:t,currentPage:l,totalItems:e});function Me(t,l){if(t&1&&(o(0,"option",14),p(1),a()),t&2){let e=l.$implicit;c("value",e),m(),q(" ",e," ")}}function Pe(t,l){if(t&1&&(o(0,"span"),p(1),a()),t&2){let e=s().$implicit;m(),$(e.title)}}function Te(t,l){if(t&1){let e=_();o(0,"input",45),w("ngModelChange",function(i){g(e);let r=s().$implicit;return E(r.title,i)||(r.title=i),d(i)}),a()}if(t&2){let e=s().$implicit;S("ngModel",e.title),c("readonly",!e.isEditing)}}function ke(t,l){if(t&1&&u(0,"div",46),t&2){let e=s().$implicit;c("innerHTML",e.description,T)}}function Fe(t,l){if(t&1){let e=_();o(0,"ckeditor",47),w("ngModelChange",function(i){g(e);let r=s().$implicit;return E(r.description,i)||(r.description=i),d(i)}),a()}if(t&2){let e=s().$implicit,n=s();S("ngModel",e.description),c("editor",n.Editor)("config",n.config)}}function Ve(t,l){if(t&1){let e=_();o(0,"button",48),C("click",function(){g(e);let i=s().$implicit,r=s();return d(r.toggleEdit(i))}),u(1,"i",49),a()}}function Ie(t,l){if(t&1){let e=_();o(0,"button",50),C("click",function(){g(e);let i=s().$implicit,r=s();return d(r.saveCategory(i))}),u(1,"i",51),a()}}function Ne(t,l){if(t&1){let e=_();o(0,"tr")(1,"td"),b(2,Pe,2,1,"span",35)(3,Te,1,2,"input",36),a(),o(4,"td"),b(5,ke,1,1,"div",37)(6,Fe,1,3,"ckeditor",38),a(),o(7,"td",39)(8,"div",40),b(9,Ve,2,0,"button",41)(10,Ie,2,0,"button",42),o(11,"button",43),C("click",function(){let i=g(e).$implicit,r=s();return d(r.deleteCategory(i))}),u(12,"i",44),a()()()()}if(t&2){let e=l.$implicit;m(2),c("ngIf",!e.isEditing),m(),c("ngIf",e.isEditing),m(2),c("ngIf",!e.isEditing),m(),c("ngIf",e.isEditing),m(3),c("ngIf",!e.isEditing),m(),c("ngIf",e.isEditing)}}function De(t,l){if(t&1){let e=_();o(0,"app-dynamic-form",52),L(1,"async"),C("submitEvent",function(i){g(e);let r=s();return d(r.handleFormSubmit(i))}),a()}if(t&2){let e=s();c("questions",Q(1,3,e.questions$))("btnText","Filter")("perPage",2)}}var at=(()=>{class t{constructor(e){this.categoryService=f(G),this.toastService=f(K),this.confirmService=f(Se),this.modalService=f(_e),this.categories=[],this.page=1,this.perPage=10,this.total=0,this.pageSizes=[10,20,30,40,50],this.isLoading=!1,this.filters={},this.currentCategory={},this.Editor=se,this.config={height:"400px",toolbar:["undo","redo","|","bold","italic","link","|","heading","|","bulletedList","numberedList"],plugins:[me,re,ce,ae,ue,pe,le,ge,de],mention:{feeds:[{marker:"@",feed:["@user","@jane","@foo","@bar"],minimumCharacters:1}]}},this.progress=0,this.questions$=e.getCategoryFiltersQuestions()}ngOnInit(){this.getCategories()}getCategories(){this.categoryService.getCategories(this.page,this.perPage,this.filters).subscribe({next:e=>{this.categories=e.data.categories,this.total=e.data.total,console.log(this.categories)}})}handlePageChange(e){this.page=e,this.getCategories()}handlePageSizeChange(e){this.perPage=e.target.value,this.page=1,this.getCategories()}handleFormSubmit(e){let n={title:e.formData.title,description:e.formData.description||""};this.filters=n,console.log(this.filters),this.page=1,this.getCategories()}toggleEdit(e){e.isEditing=!e.isEditing}saveCategory(e){e.isEditing=!1,console.log(e),this.categoryService.updateCategory(e.id,e).subscribe({next:n=>{Object.assign(e,n);let i=this.categories.findIndex(r=>r.id===e.id);i!==-1&&(this.categories[i]=e),this.toastService.success("Updated successfully")},error:n=>{console.log(n)}})}deleteCategory(e){this.confirmService.confirm("Confirm Deletion",`Are you sure you want to delete ${e.type}?`).then(n=>{n&&this.categoryService.deleteCategory(e.id).subscribe({next:i=>{console.log("Delete successful",i),this.toastService.success("Delete successful"),this.categories=this.categories.filter(r=>r.id!==e.id)},error:i=>{console.error("Error deleting category",i),this.toastService.success("Error deleting category")}})})}openModal(e,n){this.currentCategory=n,this.modalService.open(e,{centered:!0,size:"lg"})}static{this.\u0275fac=function(n){return new(n||t)(k(y))}}static{this.\u0275cmp=P({type:t,selectors:[["app-category-list"]],viewQuery:function(n,i){if(n&1&&V(M,5),n&2){let r;I(r=N())&&(i.dynamicFormComponent=r.first)}},standalone:!0,features:[B([y]),H],decls:54,vars:11,consts:[["popContent",""],[1,"container","py-4"],[1,"card"],[1,"card-header","d-flex","align-items-center"],["aria-label","breadcrumb",1,"w-100"],[1,"breadcrumb","my-auto"],[1,"breadcrumb-item"],["href","#"],[1,"breadcrumb-item","active"],["aria-current","page",1,"breadcrumb-item","active"],[1,"card-body"],[1,"row","mb-3"],[1,"col-md-3","my-auto"],[1,"p-1",3,"change"],[3,"value"],[1,"col-md-9","text-end"],["role","group","aria-label","Basic example",1,"btn-group"],["type","button",1,"btn","btn-light",3,"ngbPopover","popoverTitle","autoClose"],[1,"bi","bi-filter","me-2"],["routerLink","/categories/export",1,"btn","btn-light"],[1,"bi","bi-cloud-download","me-2"],["routerLink","/categories/import",1,"btn","btn-light"],[1,"bi","bi-cloud-upload","me-2"],["routerLink","/categories/create",1,"btn","btn-light"],[1,"bi","bi-database-add","me-2"],[1,"row"],[1,"col-lg-12"],[1,"table-responsive"],[1,"table"],[1,"bg-primary"],["scope","col"],["scope","col",1,"text-end"],[1,"row","my-3"],[1,"col-lg-10","text-center","mx-auto"],["id","categories-pagination","previousLabel","Prev","nextLabel","Next",1,"bg-success",3,"pageChange","responsive"],[4,"ngIf"],["type","text","class","form-control","required","true",3,"ngModel","readonly","ngModelChange",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["data","<p>Hello, world!</p>",3,"ngModel","editor","config","ngModelChange",4,"ngIf"],[1,"text-end"],["role","group","aria-label","Edit and Delete Button Group",1,"btn-group"],["type","button","class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["type","button","class","btn btn-success btn-sm",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"bi","bi-trash"],["type","text","required","true",1,"form-control",3,"ngModelChange","ngModel","readonly"],[3,"innerHTML"],["data","<p>Hello, world!</p>",3,"ngModelChange","ngModel","editor","config"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"bi","bi-pencil-square"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"bi","bi-check-lg"],[3,"submitEvent","questions","btnText","perPage"]],template:function(n,i){if(n&1){let r=_();o(0,"div",1)(1,"div",2)(2,"div",3)(3,"nav",4)(4,"ol",5)(5,"li",6)(6,"a",7),p(7,"Home"),a()(),o(8,"li",8),p(9,"Administration"),a(),o(10,"li",9),p(11,"Categories"),a()()()(),o(12,"div",10)(13,"div",11)(14,"div",12),p(15," Per Page: "),o(16,"select",13),C("change",function(h){return g(r),d(i.handlePageSizeChange(h))}),x(17,Me,2,2,"option",14,F),a()(),o(19,"div",15)(20,"div",16)(21,"button",17),u(22,"i",18),p(23,"Filter "),a(),o(24,"a",19),u(25,"i",20),p(26,"Export "),a(),o(27,"a",21),u(28,"i",22),p(29,"Import "),a(),o(30,"a",23),u(31,"i",24),p(32,"Add "),a()()()(),o(33,"div",25)(34,"div",26)(35,"div",27)(36,"table",28)(37,"thead")(38,"tr",29)(39,"th",30),p(40,"Title"),a(),o(41,"th",30),p(42,"Description"),a(),o(43,"th",31),p(44,"Action"),a()()(),o(45,"tbody"),x(46,Ne,13,6,"tr",null,we),L(48,"paginate"),a()()()()(),o(49,"div",32)(50,"div",33)(51,"pagination-controls",34),C("pageChange",function(h){return g(r),d(i.handlePageChange(h))}),a()()()()()(),b(52,De,2,5,"ng-template",null,0,O)}if(n&2){let r=D(53);m(17),v(i.pageSizes),m(4),c("ngbPopover",r)("popoverTitle","Filter Categories")("autoClose","outside"),m(25),v(A(48,4,i.categories,z(7,Le,i.perPage,i.page,i.total))),m(5),c("responsive",!0)}},dependencies:[ve,he,xe,ie,Z,ee,J,X,te,Y,j,M,fe,Ce,be,U,R,W,oe,ne,ye],styles:[".category-image[_ngcontent-%COMP%]{height:40px}.image-container[_ngcontent-%COMP%]:hover{cursor:pointer}"]})}}return t})();export{at as CategoryListComponent};
