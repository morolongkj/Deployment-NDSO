import{a as qe}from"./chunk-VRWIO7NF.js";import"./chunk-BYXBJQAS.js";import{b as Me,c as Le}from"./chunk-H3TTS3EI.js";import{a as X}from"./chunk-CVA5GEK5.js";import{a as Ce,b as xe,c as be,e as ye,g as ve,h as Se,i as Ee,j as we,k as Qe}from"./chunk-RGTPPWPE.js";import{a as ae,b as se,c as le,d as pe,e as ce,f as me,g as de,h as ue,i as ge,j as _e,k as fe,l as he,m as T,n as S}from"./chunk-APBDOC4F.js";import{j as J}from"./chunk-4YKIQALY.js";import{c as Y,e as Z,j as ee,p as te,q as ie,r as ne,t as oe,u as re}from"./chunk-5GXOS7PB.js";import{e as U,g as j,i as K,v as G}from"./chunk-CNFZGMVO.js";import{$b as D,Ab as f,Eb as g,Jb as h,Kb as p,Nb as M,Pb as k,Qb as W,Rb as N,Sb as $,Tb as c,Ub as v,Vb as L,Wa as I,Xb as x,Yb as b,Za as s,Zb as y,_a as V,_b as B,ac as O,dc as A,fc as q,gc as H,hc as z,ic as R,la as C,nb as _,oa as F,pb as l,vb as P,wb as w,xb as Q,ya as d,yb as n,za as u,zb as o}from"./chunk-AK6AH6QP.js";var Fe=(t,m)=>m.id,Ie=()=>["/questionnaires/create"],Ve=(t,m,e)=>({id:"Questionnaires-pagination",itemsPerPage:t,currentPage:m,totalItems:e});function Pe(t,m){if(t&1&&(n(0,"option",14),c(1),o()),t&2){let e=m.$implicit;l("value",e),s(),L(" ",e," ")}}function ke(t,m){if(t&1&&(n(0,"span"),c(1),o()),t&2){let e=p().$implicit;s(),v(e.title)}}function We(t,m){if(t&1){let e=g();n(0,"input",46),y("ngModelChange",function(i){d(e);let r=p().$implicit;return b(r.title,i)||(r.title=i),u(i)}),o()}if(t&2){let e=p().$implicit;x("ngModel",e.title),l("readonly",!e.isEditing)}}function Ne(t,m){if(t&1&&f(0,"div",47),t&2){let e=p().$implicit;l("innerHTML",e.description,I)}}function $e(t,m){if(t&1){let e=g();n(0,"ckeditor",48),y("ngModelChange",function(i){d(e);let r=p().$implicit;return b(r.description,i)||(r.description=i),u(i)}),o()}if(t&2){let e=p().$implicit,a=p();x("ngModel",e.description),l("editor",a.Editor)("config",a.config)}}function Be(t,m){if(t&1&&(n(0,"span"),c(1),o()),t&2){let e=p().$implicit;s(),v(e.status)}}function De(t,m){if(t&1){let e=g();n(0,"select",49),y("ngModelChange",function(i){d(e);let r=p().$implicit;return b(r.status,i)||(r.status=i),u(i)}),n(1,"option",14),c(2,"Open"),o(),n(3,"option",14),c(4,"Closed"),o()()}if(t&2){let e=p().$implicit;x("ngModel",e.status),s(),l("value","open"),s(2),l("value","closed")}}function Oe(t,m){if(t&1&&(n(0,"span"),c(1),o()),t&2){let e=p().$implicit;s(),v(e.open_from)}}function Ae(t,m){if(t&1){let e=g();n(0,"input",50),y("ngModelChange",function(i){d(e);let r=p().$implicit;return b(r.open_from,i)||(r.open_from=i),u(i)}),o()}if(t&2){let e=p().$implicit;x("ngModel",e.open_from),l("readonly",!e.isEditing)}}function He(t,m){if(t&1&&(n(0,"span"),c(1),o()),t&2){let e=p().$implicit;s(),v(e.open_until)}}function ze(t,m){if(t&1){let e=g();n(0,"input",50),y("ngModelChange",function(i){d(e);let r=p().$implicit;return b(r.open_until,i)||(r.open_until=i),u(i)}),o()}if(t&2){let e=p().$implicit;x("ngModel",e.open_until),l("readonly",!e.isEditing)}}function Re(t,m){if(t&1){let e=g();n(0,"button",51),h("click",function(){d(e);let i=p().$implicit,r=p();return u(r.toggleEdit(i))}),f(1,"i",52),o()}}function Ue(t,m){if(t&1){let e=g();n(0,"button",53),h("click",function(){d(e);let i=p().$implicit,r=p();return u(r.saveQuestionnaire(i))}),f(1,"i",54),o()}}function je(t,m){if(t&1){let e=g();n(0,"tr")(1,"td"),_(2,ke,2,1,"span",31)(3,We,1,2,"input",32),o(),n(4,"td"),_(5,Ne,1,1,"div",33)(6,$e,1,3,"ckeditor",34),o(),n(7,"td"),_(8,Be,2,1,"span",31)(9,De,5,3,"select",35),o(),n(10,"td"),_(11,Oe,2,1,"span",31)(12,Ae,1,2,"input",36),o(),n(13,"td"),_(14,He,2,1,"span",31)(15,ze,1,2,"input",36),o(),n(16,"td")(17,"div",37),f(18,"input",38),n(19,"label",39),c(20),o()()(),n(21,"td",40)(22,"div",41),_(23,Re,2,0,"button",42)(24,Ue,2,0,"button",43),n(25,"button",44),h("click",function(){let i=d(e).$implicit,r=p();return u(r.deleteQuestionnaire(i))}),f(26,"i",45),o()()()()}if(t&2){let e=m.$implicit;s(2),l("ngIf",!e.isEditing),s(),l("ngIf",e.isEditing),s(2),l("ngIf",!e.isEditing),s(),l("ngIf",e.isEditing),s(2),l("ngIf",!e.isEditing),s(),l("ngIf",e.isEditing),s(2),l("ngIf",!e.isEditing),s(),l("ngIf",e.isEditing),s(2),l("ngIf",!e.isEditing),s(),l("ngIf",e.isEditing),s(3),M("id",e.id),l("checked",e.is_open_forever==="1"),s(),M("for",e.id),s(),L(" ",e.is_open_forever==="0"?"Always Open":"Open Until "+e.open_until," "),s(3),l("ngIf",!e.isEditing),s(),l("ngIf",e.isEditing)}}function Ke(t,m){if(t&1){let e=g();n(0,"app-dynamic-form",55),q(1,"async"),h("submitEvent",function(i){d(e);let r=p();return u(r.handleFormSubmit(i))}),o()}if(t&2){let e=p();l("questions",H(1,3,e.questions$))("btnText","Filter")("perPage",2)}}var vt=(()=>{class t{constructor(e){this.questionnaireService=C(qe),this.toastService=C(J),this.confirmService=C(Qe),this.categoryService=C(X),this.modalService=C(Ce),this.questionnaires=[],this.page=1,this.perPage=10,this.total=0,this.pageSizes=[10,20,30,40,50],this.isLoading=!1,this.filters={},this.currentQuestionnaire={},this.Editor=ce,this.config={height:"400px",toolbar:["undo","redo","|","bold","italic","link","|","heading","|","bulletedList","numberedList"],plugins:[ge,le,de,pe,he,ue,me,_e,fe],mention:{feeds:[{marker:"@",feed:["@user","@jane","@foo","@bar"],minimumCharacters:1}]}},this.progress=0,this.questions$=e.getCategoryFiltersQuestions()}ngOnInit(){this.getQuestionnaires()}getQuestionnaires(){this.questionnaireService.getQuestionnaires(this.page,this.perPage,this.filters).subscribe({next:e=>{this.questionnaires=e.data.questionnaires,this.total=e.data.total,console.log(this.questionnaires)}})}handlePageChange(e){this.page=e,this.getQuestionnaires()}handlePageSizeChange(e){this.perPage=e.target.value,this.page=1,this.getQuestionnaires()}handleFormSubmit(e){let a={title:e.formData.title,description:e.formData.description||""};this.filters=a,console.log(this.filters),this.page=1,this.getQuestionnaires()}toggleEdit(e){e.isEditing=!e.isEditing}saveQuestionnaire(e){e.isEditing=!1,console.log(e),this.questionnaireService.updateQuestionnaire(e.id,e).subscribe({next:a=>{Object.assign(e,a);let i=this.questionnaires.findIndex(r=>r.id===e.id);i!==-1&&(this.questionnaires[i]=e),this.toastService.success("Updated successfully")},error:a=>{console.log(a)}})}deleteQuestionnaire(e){this.confirmService.confirm("Confirm Deletion",`Are you sure you want to delete ${e.type}?`).then(a=>{a&&this.questionnaireService.deleteQuestionnaire(e.id).subscribe({next:i=>{console.log("Delete successful",i),this.toastService.success("Delete successful"),this.questionnaires=this.questionnaires.filter(r=>r.id!==e.id)},error:i=>{console.error("Error deleting questionnaire",i),this.toastService.success("Error deleting questionnaire")}})})}openModal(e,a){this.currentQuestionnaire=a,this.modalService.open(e,{centered:!0,size:"lg"})}static{this.\u0275fac=function(a){return new(a||t)(V(S))}}static{this.\u0275cmp=F({type:t,selectors:[["app-admin-questionnaire-list"]],viewQuery:function(a,i){if(a&1&&k(T,5),a&2){let r;W(r=N())&&(i.dynamicFormComponent=r.first)}},standalone:!0,features:[B([S]),D],decls:56,vars:13,consts:[["popContent",""],[1,"container","min-vh-100","py-4"],[1,"card"],[1,"card-header","d-flex","align-items-center"],["aria-label","breadcrumb",1,"w-100"],[1,"breadcrumb","my-auto"],[1,"breadcrumb-item"],["href","#"],[1,"breadcrumb-item","active"],["aria-current","page",1,"breadcrumb-item","active"],[1,"card-body"],[1,"row","mb-3"],[1,"col-md-3","my-auto"],[1,"p-1",3,"change"],[3,"value"],[1,"col-md-9","text-end"],["role","group","aria-label","Basic example",1,"btn-group"],["type","button",1,"btn","btn-light",3,"ngbPopover","popoverTitle","autoClose"],[1,"bi","bi-filter","me-2"],[1,"btn","btn-light",3,"routerLink"],[1,"bi","bi-database-add","me-2"],[1,"row"],[1,"col-lg-12"],[1,"table-responsive"],[1,"table"],[1,"bg-primary"],["scope","col"],["scope","col",1,"text-end"],[1,"row","my-3"],[1,"col-lg-10","text-center","mx-auto"],["id","Questionnaires-pagination","previousLabel","Prev","nextLabel","Next",1,"bg-success",3,"pageChange","responsive"],[4,"ngIf"],["type","text","class","form-control","required","true",3,"ngModel","readonly","ngModelChange",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["data","<p>Hello, world!</p>",3,"ngModel","editor","config","ngModelChange",4,"ngIf"],["class","form-control","required","",3,"ngModel","ngModelChange",4,"ngIf"],["type","date","class","form-control","required","true",3,"ngModel","readonly","ngModelChange",4,"ngIf"],[1,"form-check","form-switch"],["type","checkbox",1,"form-check-input",3,"id","checked"],[1,"form-check-label",3,"for"],[1,"text-end"],["role","group","aria-label","Edit and Delete Button Group",1,"btn-group"],["type","button","class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["type","button","class","btn btn-success btn-sm",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"bi","bi-trash"],["type","text","required","true",1,"form-control",3,"ngModelChange","ngModel","readonly"],[3,"innerHTML"],["data","<p>Hello, world!</p>",3,"ngModelChange","ngModel","editor","config"],["required","",1,"form-control",3,"ngModelChange","ngModel"],["type","date","required","true",1,"form-control",3,"ngModelChange","ngModel","readonly"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"bi","bi-pencil-square"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"bi","bi-check-lg"],[3,"submitEvent","questions","btnText","perPage"]],template:function(a,i){if(a&1){let r=g();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"nav",4)(4,"ol",5)(5,"li",6)(6,"a",7),c(7,"Home"),o()(),n(8,"li",8),c(9,"Quality Assurance"),o(),n(10,"li",9),c(11," Questionnaires "),o()()()(),n(12,"div",10)(13,"div",11)(14,"div",12),c(15," Per Page: "),n(16,"select",13),h("change",function(E){return d(r),u(i.handlePageSizeChange(E))}),w(17,Pe,2,2,"option",14,P),o()(),n(19,"div",15)(20,"div",16)(21,"button",17),f(22,"i",18),c(23,"Filter "),o(),n(24,"a",19),f(25,"i",20),c(26,"Add "),o()()()(),n(27,"div",21)(28,"div",22)(29,"div",23)(30,"table",24)(31,"thead")(32,"tr",25)(33,"th",26),c(34,"Title"),o(),n(35,"th",26),c(36,"Description"),o(),n(37,"th",26),c(38,"Status"),o(),n(39,"th",26),c(40,"Open From"),o(),n(41,"th",26),c(42,"Open Until"),o(),n(43,"th",26),c(44,"Always Receive Submissions?"),o(),n(45,"th",27),c(46,"Action"),o()()(),n(47,"tbody"),w(48,je,27,16,"tr",null,Fe),q(50,"paginate"),o()()()()(),n(51,"div",28)(52,"div",29)(53,"pagination-controls",30),h("pageChange",function(E){return d(r),u(i.handlePageChange(E))}),o()()()()()(),_(54,Ke,2,5,"ng-template",null,0,R)}if(a&2){let r=$(55);s(17),Q(i.pageSizes),s(4),l("ngbPopover",r)("popoverTitle","Filter Questionnaires")("autoClose","outside"),s(3),l("routerLink",O(8,Ie)),s(24),Q(z(50,5,i.questionnaires,A(9,Ve,i.perPage,i.page,i.total))),s(5),l("responsive",!0)}},dependencies:[we,Se,Ee,re,ie,ne,Y,te,Z,oe,ee,j,T,be,xe,ye,G,K,U,Me,Le,se,ae,ve]})}}return t})();export{vt as QuestionnaireListComponent};
