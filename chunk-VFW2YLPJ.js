import"./chunk-BYXBJQAS.js";import{a as we,b as Le,c as Me}from"./chunk-TBPE5XZ7.js";import{a as X}from"./chunk-AH2EGK5Q.js";import{a as J}from"./chunk-E7KANFFP.js";import{a as be,b as he,c as Ce,e as xe,g as ye,h as ve,i as Pe,j as Se,k as Ee}from"./chunk-VUYJUVQ5.js";import{a as re,b as ae,c as ce,d as se,e as le,f as de,g as pe,h as me,i as ue,j as ge,k as _e,l as fe,m as T,n as S}from"./chunk-UZNDUMES.js";import{i as G}from"./chunk-AGSWOYKP.js";import{c as Y,e as Z,j as ee,q as te,r as ie,t as ne,u as oe}from"./chunk-JCKB2E4I.js";import"./chunk-N6Q423HR.js";import{e as j,g as R,j as U,w as K}from"./chunk-4WYIZYTR.js";import{$b as H,Ab as _,Eb as g,Jb as b,Kb as l,Pb as N,Qb as $,Rb as W,Sb as D,Tb as p,Ub as v,Vb as B,Wa as V,Xb as C,Yb as x,Za as s,Zb as y,_a as I,_b as q,ac as P,dc as z,fc as M,gc as Q,hc as A,ic as O,la as h,nb as f,oa as F,pb as c,vb as k,wb as w,xb as L,ya as m,yb as n,za as u,zb as r}from"./chunk-N6N27DRQ.js";var Fe=(t,d)=>d.id,Ve=()=>["/products/export"],Ie=()=>["/products/import"],ke=()=>["/products/create"],Ne=(t,d,e)=>({id:"Products-pagination",itemsPerPage:t,currentPage:d,totalItems:e});function $e(t,d){if(t&1&&(n(0,"option",14),p(1),r()),t&2){let e=d.$implicit;c("value",e),s(),B(" ",e," ")}}function We(t,d){if(t&1&&(n(0,"span"),p(1),r()),t&2){let e=l().$implicit;s(),v(e.code)}}function De(t,d){if(t&1){let e=g();n(0,"input",44),y("ngModelChange",function(i){m(e);let a=l().$implicit;return x(a.code,i)||(a.code=i),u(i)}),r()}if(t&2){let e=l().$implicit;C("ngModel",e.code),c("readonly",!e.isEditing)}}function Be(t,d){if(t&1&&(n(0,"span"),p(1),r()),t&2){let e=l().$implicit;s(),v(e.title)}}function qe(t,d){if(t&1){let e=g();n(0,"input",44),y("ngModelChange",function(i){m(e);let a=l().$implicit;return x(a.title,i)||(a.title=i),u(i)}),r()}if(t&2){let e=l().$implicit;C("ngModel",e.title),c("readonly",!e.isEditing)}}function He(t,d){if(t&1&&_(0,"div",45),t&2){let e=l().$implicit;c("innerHTML",e.description,V)}}function ze(t,d){if(t&1){let e=g();n(0,"ckeditor",46),y("ngModelChange",function(i){m(e);let a=l().$implicit;return x(a.description,i)||(a.description=i),u(i)}),r()}if(t&2){let e=l().$implicit,o=l();C("ngModel",e.description),c("editor",o.Editor)("config",o.config)}}function Qe(t,d){if(t&1&&(n(0,"span"),p(1),r()),t&2){let e=l().$implicit;s(),v(e.category)}}function Ae(t,d){if(t&1){let e=g();n(0,"ng-select",47),y("ngModelChange",function(i){m(e);let a=l().$implicit;return x(a.category_id,i)||(a.category_id=i),u(i)}),r()}if(t&2){let e=l().$implicit,o=l();C("ngModel",e.category_id),c("items",o.categories)("searchable",!0)}}function Oe(t,d){if(t&1){let e=g();n(0,"button",48),b("click",function(){m(e);let i=l().$implicit,a=l();return u(a.toggleEdit(i))}),_(1,"i",49),r()}}function je(t,d){if(t&1){let e=g();n(0,"button",50),b("click",function(){m(e);let i=l().$implicit,a=l();return u(a.saveProduct(i))}),_(1,"i",51),r()}}function Re(t,d){if(t&1){let e=g();n(0,"tr")(1,"td"),f(2,We,2,1,"span",33)(3,De,1,2,"input",34),r(),n(4,"td"),f(5,Be,2,1,"span",33)(6,qe,1,2,"input",34),r(),n(7,"td"),f(8,He,1,1,"div",35)(9,ze,1,3,"ckeditor",36),r(),n(10,"td"),f(11,Qe,2,1,"span",33)(12,Ae,1,3,"ng-select",37),r(),n(13,"td",38)(14,"div",39),f(15,Oe,2,0,"button",40)(16,je,2,0,"button",41),n(17,"button",42),b("click",function(){let i=m(e).$implicit,a=l();return u(a.deleteProduct(i))}),_(18,"i",43),r()()()()}if(t&2){let e=d.$implicit;s(2),c("ngIf",!e.isEditing),s(),c("ngIf",e.isEditing),s(2),c("ngIf",!e.isEditing),s(),c("ngIf",e.isEditing),s(2),c("ngIf",!e.isEditing),s(),c("ngIf",e.isEditing),s(2),c("ngIf",!e.isEditing),s(),c("ngIf",e.isEditing),s(3),c("ngIf",!e.isEditing),s(),c("ngIf",e.isEditing)}}function Ue(t,d){if(t&1){let e=g();n(0,"app-dynamic-form",52),M(1,"async"),b("submitEvent",function(i){m(e);let a=l();return u(a.handleFormSubmit(i))}),r()}if(t&2){let e=l();c("questions",Q(1,3,e.questions$))("btnText","Filter")("perPage",2)}}var vt=(()=>{class t{constructor(e){this.productService=h(X),this.toastService=h(G),this.confirmService=h(Ee),this.categoryService=h(J),this.modalService=h(be),this.products=[],this.page=1,this.perPage=10,this.total=0,this.pageSizes=[10,20,30,40,50],this.isLoading=!1,this.filters={},this.currentProduct={},this.categories=[],this.categoriesLoading=!1,this.Editor=le,this.config={height:"400px",toolbar:["undo","redo","|","bold","italic","link","|","heading","|","bulletedList","numberedList"],plugins:[ue,ce,pe,se,fe,me,de,ge,_e],mention:{feeds:[{marker:"@",feed:["@user","@jane","@foo","@bar"],minimumCharacters:1}]}},this.progress=0,this.questions$=e.getCategoryFiltersQuestions()}ngOnInit(){this.getProducts(),this.categoriesLoading=!0,this.categoryService.getCategories().subscribe({next:e=>{e.data.categories.forEach(o=>this.categories.push({label:o.title,value:o.id})),this.categoriesLoading=!1}})}getProducts(){this.productService.getProducts(this.page,this.perPage,this.filters).subscribe({next:e=>{this.products=e.data.products,this.total=e.data.total,console.log(this.products)}})}handlePageChange(e){this.page=e,this.getProducts()}handlePageSizeChange(e){this.perPage=e.target.value,this.page=1,this.getProducts()}handleFormSubmit(e){let o={title:e.formData.title,description:e.formData.description||""};this.filters=o,console.log(this.filters),this.page=1,this.getProducts()}toggleEdit(e){e.isEditing=!e.isEditing}saveProduct(e){e.isEditing=!1,console.log(e),this.productService.updateProduct(e.id,e).subscribe({next:o=>{Object.assign(e,o);let i=this.products.findIndex(a=>a.id===e.id);i!==-1&&(this.products[i]=e),this.toastService.success("Updated successfully")},error:o=>{console.log(o)}})}deleteProduct(e){this.confirmService.confirm("Confirm Deletion",`Are you sure you want to delete ${e.type}?`).then(o=>{o&&this.productService.deleteProduct(e.id).subscribe({next:i=>{console.log("Delete successful",i),this.toastService.success("Delete successful"),this.products=this.products.filter(a=>a.id!==e.id)},error:i=>{console.error("Error deleting product",i),this.toastService.success("Error deleting product")}})})}openModal(e,o){this.currentProduct=o,this.modalService.open(e,{centered:!0,size:"lg"})}static{this.\u0275fac=function(o){return new(o||t)(I(S))}}static{this.\u0275cmp=F({type:t,selectors:[["app-admin-product-list"]],viewQuery:function(o,i){if(o&1&&N(T,5),o&2){let a;$(a=W())&&(i.dynamicFormComponent=a.first)}},standalone:!0,features:[q([S]),H],decls:58,vars:17,consts:[["popContent",""],[1,"container","min-vh-100","py-4"],[1,"card"],[1,"card-header","d-flex","align-items-center"],["aria-label","breadcrumb",1,"w-100"],[1,"breadcrumb","my-auto"],[1,"breadcrumb-item"],["href","#"],[1,"breadcrumb-item","active"],["aria-current","page",1,"breadcrumb-item","active"],[1,"card-body"],[1,"row","mb-3"],[1,"col-md-3","my-auto"],[1,"p-1",3,"change"],[3,"value"],[1,"col-md-9","text-end"],["role","group","aria-label","Basic example",1,"btn-group"],["type","button",1,"btn","btn-light",3,"ngbPopover","popoverTitle","autoClose"],[1,"bi","bi-filter","me-2"],[1,"btn","btn-light",3,"routerLink"],[1,"bi","bi-cloud-download","me-2"],[1,"bi","bi-cloud-upload","me-2"],[1,"bi","bi-database-add","me-2"],[1,"row"],[1,"col-lg-12"],[1,"table-responsive"],[1,"table"],[1,"bg-primary"],["scope","col"],["scope","col",1,"text-end"],[1,"row","my-3"],[1,"col-lg-10","text-center","mx-auto"],["id","Products-pagination","previousLabel","Prev","nextLabel","Next",1,"bg-success",3,"pageChange","responsive"],[4,"ngIf"],["type","text","class","form-control","required","true",3,"ngModel","readonly","ngModelChange",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["data","<p>Hello, world!</p>",3,"ngModel","editor","config","ngModelChange",4,"ngIf"],["bindLabel","label","bindValue","value","placeholder","Select type",3,"ngModel","items","searchable","ngModelChange",4,"ngIf"],[1,"text-end"],["role","group","aria-label","Edit and Delete Button Group",1,"btn-group"],["type","button","class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["type","button","class","btn btn-success btn-sm",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"bi","bi-trash"],["type","text","required","true",1,"form-control",3,"ngModelChange","ngModel","readonly"],[3,"innerHTML"],["data","<p>Hello, world!</p>",3,"ngModelChange","ngModel","editor","config"],["bindLabel","label","bindValue","value","placeholder","Select type",3,"ngModelChange","ngModel","items","searchable"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"bi","bi-pencil-square"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"bi","bi-check-lg"],[3,"submitEvent","questions","btnText","perPage"]],template:function(o,i){if(o&1){let a=g();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"nav",4)(4,"ol",5)(5,"li",6)(6,"a",7),p(7,"Home"),r()(),n(8,"li",8),p(9,"Administration"),r(),n(10,"li",9),p(11,"Products"),r()()()(),n(12,"div",10)(13,"div",11)(14,"div",12),p(15," Per Page: "),n(16,"select",13),b("change",function(E){return m(a),u(i.handlePageSizeChange(E))}),w(17,$e,2,2,"option",14,k),r()(),n(19,"div",15)(20,"div",16)(21,"button",17),_(22,"i",18),p(23,"Filter "),r(),n(24,"a",19),_(25,"i",20),p(26,"Export "),r(),n(27,"a",19),_(28,"i",21),p(29,"Import "),r(),n(30,"a",19),_(31,"i",22),p(32,"Add "),r()()()(),n(33,"div",23)(34,"div",24)(35,"div",25)(36,"table",26)(37,"thead")(38,"tr",27)(39,"th",28),p(40,"Code"),r(),n(41,"th",28),p(42,"Title"),r(),n(43,"th",28),p(44,"Description"),r(),n(45,"th",28),p(46,"Category"),r(),n(47,"th",29),p(48,"Action"),r()()(),n(49,"tbody"),w(50,Re,19,10,"tr",null,Fe),M(52,"paginate"),r()()()()(),n(53,"div",30)(54,"div",31)(55,"pagination-controls",32),b("pageChange",function(E){return m(a),u(i.handlePageChange(E))}),r()()()()()(),f(56,Ue,2,5,"ng-template",null,0,O)}if(o&2){let a=D(57);s(17),L(i.pageSizes),s(4),c("ngbPopover",a)("popoverTitle","Filter Products")("autoClose","outside"),s(3),c("routerLink",P(10,Ve)),s(3),c("routerLink",P(11,Ie)),s(3),c("routerLink",P(12,ke)),s(20),L(A(52,7,i.products,z(13,Ne,i.perPage,i.page,i.total))),s(5),c("responsive",!0)}},dependencies:[Se,ve,Pe,oe,te,ie,Y,Z,ne,ee,R,T,Ce,he,xe,K,U,j,Le,we,Me,ae,re,ye]})}}return t})();export{vt as ProductListComponent};
