import{a as L}from"./chunk-UWFO4RV2.js";import{b as Se,i as Ce,j as xe,k as ye}from"./chunk-BKHC57ZA.js";import{a as le,b as me,c as ce,d as pe,e as de,f as ue,g as fe,h as he,i as _e,j as ge,k as be,l as ve}from"./chunk-S7AA3UJJ.js";import{i as W}from"./chunk-SOBBRMPV.js";import{c as X,d as k,e as Y,f as Z,k as ee,n as te,o as ie,p as ne,q as re,w as oe,x as ae,y as se}from"./chunk-22GTFEIV.js";import"./chunk-76MW4KX4.js";import{c as J}from"./chunk-E4MEA7MR.js";import{j as H,k as K,p as F}from"./chunk-N57PBUIL.js";import{Ab as p,Bb as z,Cb as G,Eb as b,Jb as d,Kb as _,Ob as I,T as N,Tb as q,Ub as a,Vb as w,Wa as $,Wb as x,Za as s,_ as P,_a as j,aa as D,ac as Q,ec as U,fa as M,gc as R,ic as B,jc as V,ka as A,la as g,n as O,nb as v,oa as y,pb as c,vb as E,wb as S,xb as C,ya as u,yb as i,za as f,zb as n}from"./chunk-MLHGNWXV.js";function ke(t,m){if(t&1){let e=b();i(0,"tr",14)(1,"td"),a(2),n(),i(3,"td")(4,"input",15),d("change",function(r){let l=u(e).index,h=_();return f(h.onFileChange(r,l))}),n()(),i(5,"td"),p(6,"input",16),n(),i(7,"td")(8,"button",17),d("click",function(){let r=u(e).index,l=_();return f(l.removeAttachment(r))}),p(9,"i",18),n()()()}if(t&2){let e=m.index;c("formGroupName",e),s(2),w(e+1),s(2),I("id","file-",e,""),s(2),I("id","name-",e,"")}}var we=(()=>{class t{constructor(e){this.fb=e,this.questionnaireService=g(L),this.questionnaire={},this.Editor=de,this.config={height:"400px",toolbar:["undo","redo","|","bold","italic","link","|","heading","|","bulletedList","numberedList"],plugins:[_e,ce,fe,pe,ve,he,ue,ge,be],mention:{feeds:[{marker:"@",feed:["@user","@jane","@foo","@bar"],minimumCharacters:1}]}},this.form=this.fb.group({message:["",k.required],attachments:this.fb.array([])})}ngOnInit(){}get attachments(){return this.form.get("attachments")}createAttachment(){return this.fb.group({name:["",k.required],file:[null,k.required]})}addAttachment(){this.attachments.push(this.createAttachment())}removeAttachment(e){this.attachments.removeAt(e)}onSubmit(){if(this.form.valid){console.log(this.form.value);let e=new FormData;e.append("message",this.form.value.message),this.form.value.attachments.forEach((o,r)=>{o.file&&(e.append(`attachments[${r}][file_name]`,o.name),e.append(`attachments[${r}][file]`,o.file))}),console.log(e)}}onFileChange(e,o){let r=e.target.files[0];r&&this.attachments.at(o).patchValue({file:r})}static{this.\u0275fac=function(o){return new(o||t)(j(oe))}}static{this.\u0275cmp=y({type:t,selectors:[["app-submit-questionnaire"]],inputs:{questionnaire:"questionnaire"},standalone:!0,features:[Q],decls:25,vars:5,consts:[[3,"ngSubmit","formGroup"],[1,"form-group"],["formControlName","message","id","message","data","<p>Hello, world!</p>",3,"editor","config"],[1,"form-group","mt-3"],[1,"table","table-bordered"],[1,"text-end"],["type","button",1,"btn","btn-primary",3,"click"],[1,"bi","bi-paperclip"],["formArrayName","attachments"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"row","my-3"],[1,"col-lg-12","text-end"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"bi","bi-send","ms-2"],[3,"formGroupName"],["type","file",1,"form-control",3,"change","id"],["type","text","formControlName","name","placeholder","Enter attachment name",1,"form-control",3,"id"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"bi","bi-trash"]],template:function(o,r){o&1&&(i(0,"form",0),d("ngSubmit",function(){return r.onSubmit()}),i(1,"div",1),p(2,"ckeditor",2),n(),i(3,"div",3)(4,"h6"),a(5,"Attachments"),n(),i(6,"table",4)(7,"thead")(8,"tr")(9,"th"),a(10,"#"),n(),i(11,"th"),a(12,"File"),n(),i(13,"th"),a(14,"Attachment Name"),n(),i(15,"th",5)(16,"button",6),d("click",function(){return r.addAttachment()}),p(17,"i",7),n()()()(),i(18,"tbody",8),v(19,ke,10,6,"tr",9),n()()(),i(20,"div",10)(21,"div",11)(22,"button",12),a(23," Submit "),p(24,"i",13),n()()()()),o&2&&(c("formGroup",r.form),s(2),c("editor",r.Editor)("config",r.config),s(17),c("ngForOf",r.attachments.controls),s(3),c("disabled",r.form.invalid))},dependencies:[F,H,ae,ee,X,Y,Z,se,te,re,ie,ne,me,le]})}}return t})();var Qe=(()=>{class t{constructor(e){this.http=e}downloadFile(e,o){this.http.get(e,{responseType:"blob"}).subscribe(r=>{let l=document.createElement("a"),h=URL.createObjectURL(r);l.href=h,l.download=o,l.click(),URL.revokeObjectURL(h)},r=>{console.error("Download failed:",r)})}static{this.\u0275fac=function(o){return new(o||t)(A(J))}}static{this.\u0275prov=M({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Le=(t,m)=>m.id,Te=(t,m,e)=>({id:"Questionnaires-pagination",itemsPerPage:t,currentPage:m,totalItems:e});function Ie(t,m){if(t&1&&(i(0,"option",12),a(1),n()),t&2){let e=m.$implicit;c("value",e),s(),x(" ",e," ")}}function qe(t,m){if(t&1&&(i(0,"li",23),a(1),n()),t&2){let e=m.$implicit;s(),x(" ",e.title," ")}}function Ve(t,m){if(t&1){let e=b();i(0,"li",23),a(1),i(2,"button",26),d("click",function(){let r=u(e).$implicit,l=_(3);return f(l.download(r))}),p(3,"i",27),n()()}if(t&2){let e=m.$implicit;s(),x(" ",e.file_name," ")}}function Oe(t,m){if(t&1){let e=b();i(0,"tr")(1,"td")(2,"span"),a(3),n()(),i(4,"td"),p(5,"div",22),n(),i(6,"td")(7,"ul"),S(8,qe,2,1,"li",23,E),n()(),i(10,"td")(11,"ul"),S(12,Ve,4,1,"li",23,E),n()(),i(14,"td",24)(15,"button",25),d("click",function(){let r=u(e).$implicit,l=_(2),h=q(38);return f(l.openModal(h,r))}),a(16," Submit Questionnaire "),n()()()}if(t&2){let e=m.$implicit;s(3),w(e.title),s(2),c("innerHTML",e.description,$),s(3),C(e.products),s(4),C(e.documents)}}function Ne(t,m){if(t&1&&(z(0),S(1,Oe,17,2,"tr",null,Le),R(3,"paginate"),G()),t&2){let e=_();s(),C(B(3,0,e.questionnaires,U(3,Te,e.perPage,e.page,e.total)))}}function Pe(t,m){t&1&&(i(0,"tr")(1,"td",28),p(2,"i",29),i(3,"div"),a(4,"No questionnaires available"),n()()())}function De(t,m){if(t&1){let e=b();i(0,"div",30)(1,"h5",31),a(2),n(),i(3,"button",32),d("click",function(){let r=u(e).$implicit;return f(r.dismiss("Cross click"))}),n()(),i(4,"div",33),p(5,"app-submit-questionnaire",34),n()}if(t&2){let e=_();s(2),x(" Submit Questionnaire: ",e.currentQuestionnaire.title," "),s(3),c("questionnaire",e.currentQuestionnaire)}}var lt=(()=>{class t{constructor(){this.questionnaireService=g(L),this.toastService=g(W),this.modalService=g(Se),this.fileDownloadService=g(Qe),this.questionnaires=[],this.page=1,this.perPage=10,this.total=0,this.pageSizes=[10,20,30,40,50],this.isLoading=!1,this.filters={status:"open"},this.unsubscribe$=new O,this.currentQuestionnaire={}}ngOnInit(){this.loadQuestionnaires()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}loadQuestionnaires(){this.questionnaireService.getQuestionnaires(this.page,this.perPage,this.filters).pipe(D({next:e=>{e&&(this.questionnaires=e.data.questionnaires,console.log(this.questionnaires))},error:e=>alert(e)}),N(()=>this.isLoading=!1),P(this.unsubscribe$)).subscribe()}handlePageChange(e){this.page=e,this.loadQuestionnaires()}handlePageSizeChange(e){this.perPage=e.target.value,this.page=1,this.loadQuestionnaires()}openModal(e,o){this.currentQuestionnaire=o,this.modalService.open(e,{centered:!0,size:"lg"})}download(e){let o="https://example.com/path-to-your-file.pdf",r="downloaded-file.pdf";this.fileDownloadService.downloadFile(e.file_path,e.file_name)}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=y({type:t,selectors:[["app-open-questionnaire-list"]],standalone:!0,features:[Q],decls:39,vars:3,consts:[["noData",""],["content",""],[1,"container","min-vh-100","my-5"],[1,"row"],[1,"col-lg-12"],[1,"card"],[1,"card-body"],["data-aos","fade-down","data-aos-duration","2000",1,"card-title"],["data-aos","fade-right","data-aos-duration","2000",1,"custom-hr"],[1,"row","mb-3"],[1,"col-md-2","my-auto","ms-auto"],[1,"p-1",3,"change"],[3,"value"],[1,"row","my-3"],[1,"table-responsive"],[1,"table"],[1,"bg-primary"],["scope","col"],["scope","col",1,"text-end"],[4,"ngIf","ngIfElse"],[1,"col-lg-10","text-center","mx-auto"],["id","Questionnaires-pagination","previousLabel","Prev","nextLabel","Next",1,"bg-success",3,"pageChange","responsive"],[3,"innerHTML"],[1,"text-wrap"],[1,"text-end"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"btn","btn-light",3,"click"],[1,"bi","bi-download"],["colspan","9",1,"text-center","text-muted","py-4"],[1,"bi","bi-emoji-frown",2,"font-size","2rem"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"questionnaire"]],template:function(o,r){if(o&1){let l=b();i(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"h5",7),a(6," Questionnaires "),n(),p(7,"hr",8),i(8,"div",9)(9,"div",10),a(10," Per Page: "),i(11,"select",11),d("change",function(T){return u(l),f(r.handlePageSizeChange(T))}),S(12,Ie,2,2,"option",12,E),n()()(),i(14,"div",13)(15,"div",4)(16,"div",14)(17,"table",15)(18,"thead")(19,"tr",16)(20,"th",17),a(21,"Title"),n(),i(22,"th",17),a(23,"Description"),n(),i(24,"th",17),a(25,"Products"),n(),i(26,"th",17),a(27,"Attachments"),n(),i(28,"th",18),a(29,"Action"),n()()(),i(30,"tbody"),v(31,Ne,4,7,"ng-container",19)(32,Pe,5,0,"ng-template",null,0,V),n()()()()(),i(34,"div",13)(35,"div",20)(36,"pagination-controls",21),d("pageChange",function(T){return u(l),f(r.handlePageChange(T))}),n()()()()()()()(),v(37,De,6,2,"ng-template",null,1,V)}if(o&2){let l=q(33);s(12),C(r.pageSizes),s(19),c("ngIf",r.questionnaires.length>0)("ngIfElse",l),s(5),c("responsive",!0)}},dependencies:[ye,Ce,xe,F,K,we]})}}return t})();export{lt as OpenQuestionnaireListComponent};
